<script>
let lastUrl = "";

async function checkVideo() {
  try {
    const res = await fetch("https://api.jsonbin.io/v3/b/698a228cd0ea881f40ada6fc");
    const json = await res.json();
    const data = json.record;

    if (!data.video || data.video === lastUrl) return;
    lastUrl = data.video;

    document.getElementById("msg").innerText = data.message || "";

    const player = document.getElementById("player");
    player.innerHTML = "";

    const iframe = document.createElement("iframe");
    iframe.src = data.video + "?autoplay=1&mute=1";
    iframe.width = "560";
    iframe.height = "315";
    iframe.allow = "autoplay; fullscreen";
    iframe.allowFullscreen = true;

    player.appendChild(iframe);

  } catch (e) {
    console.error(e);
  }
}

checkVideo();
setInterval(checkVideo, 2000);
</script>
